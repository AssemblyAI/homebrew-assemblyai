# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class Assemblyai < Formula
  desc "A quick and easy way to test assemblyAI's transcription features on your terminal"
  homepage "https://www.assemblyai.com/"
  version "0.19"
  license "Apache 2.0"

  on_macos do
    if Hardware::CPU.intel?
      url "https://github.com/AssemblyAI/assemblyai-cli/releases/download/v0.19/assemblyai_0.19_darwin_amd64.tar.gz"
      sha256 "3e556a3159ba1f987d7c4e8927f0a58e507b047cc8410ea0df529eee04a4672f"

      def install
        bin.install "assemblyai"
      end
    end
    if Hardware::CPU.arm?
      url "https://github.com/AssemblyAI/assemblyai-cli/releases/download/v0.19/assemblyai_0.19_darwin_arm64.tar.gz"
      sha256 "c4f34355bd66024ad5706098043ff362a8c82fecaf0d31891fa28e5f092befa7"

      def install
        bin.install "assemblyai"
      end
    end
  end

  on_linux do
    if Hardware::CPU.intel?
      url "https://github.com/AssemblyAI/assemblyai-cli/releases/download/v0.19/assemblyai_0.19_linux_amd64.tar.gz"
      sha256 "d2a6c532c3b9b57c17d612d6b78c0ed538d0e1fc0b30694bbba5a0471a0685a2"

      def install
        bin.install "assemblyai"
      end
    end
    if Hardware::CPU.arm? && !Hardware::CPU.is_64_bit?
      url "https://github.com/AssemblyAI/assemblyai-cli/releases/download/v0.19/assemblyai_0.19_linux_armv6.tar.gz"
      sha256 "1cfeac8ca8c350130d71eeab085c66d8cd28c3e98a1d82c310f0ad737f8ccc47"

      def install
        bin.install "assemblyai"
      end
    end
    if Hardware::CPU.arm? && Hardware::CPU.is_64_bit?
      url "https://github.com/AssemblyAI/assemblyai-cli/releases/download/v0.19/assemblyai_0.19_linux_arm64.tar.gz"
      sha256 "d2dec4e0350c69259ba67908f4d15f521640cfea15135d0612263fd5ec07e0f5"

      def install
        bin.install "assemblyai"
      end
    end
  end

  test do
    output = shell_output("#{bin}/assemblyai-cli config 1234567890")
    expected = "Invalid token. Try again, and if the problem persists, contact support at support@assemblyai.com"
    assert_match expected, output

    output = shell_output("#{bin}/assemblyai-cli transcribe 1234567890")
    assert_match "You must login first. Run `assemblyai config <token>`\n", output

    output = shell_output("#{bin}/assemblyai-cli get 1234567890")
    assert_match "You must login first. Run `assemblyai config <token>`\n", output
  end
end
