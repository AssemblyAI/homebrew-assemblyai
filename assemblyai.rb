# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class Assemblyai < Formula
  desc "A quick and easy way to test assemblyAI's transcription features on your terminal"
  homepage "https://www.assemblyai.com/"
  version "0.15"
  license "Apache 2.0"

  on_macos do
    if Hardware::CPU.arm?
      url "https://github.com/AssemblyAI/assemblyai-cli/releases/download/v0.15/assemblyai_0.15_darwin_arm64.tar.gz"
      sha256 "0dbbe2a81e2ea89334588369dff6197cda089b7f25c9b1d5e9c712fb5c4d840e"

      def install
        bin.install "assemblyai"
      end
    end
    if Hardware::CPU.intel?
      url "https://github.com/AssemblyAI/assemblyai-cli/releases/download/v0.15/assemblyai_0.15_darwin_amd64.tar.gz"
      sha256 "010035eb19db69308eff90959c5c633deff702360b0424baa56bf4cab97e700b"

      def install
        bin.install "assemblyai"
      end
    end
  end

  on_linux do
    if Hardware::CPU.arm? && !Hardware::CPU.is_64_bit?
      url "https://github.com/AssemblyAI/assemblyai-cli/releases/download/v0.15/assemblyai_0.15_linux_armv6.tar.gz"
      sha256 "b9fdfe08108eaa4bf1a9a70b294817a21006330de0fe686f5dfcd67e1273089b"

      def install
        bin.install "assemblyai"
      end
    end
    if Hardware::CPU.arm? && Hardware::CPU.is_64_bit?
      url "https://github.com/AssemblyAI/assemblyai-cli/releases/download/v0.15/assemblyai_0.15_linux_arm64.tar.gz"
      sha256 "d709ecc0a0fb24016d98517ce2f5a34e153d2ae4a9017ad79c6bc0c46fb22c02"

      def install
        bin.install "assemblyai"
      end
    end
    if Hardware::CPU.intel?
      url "https://github.com/AssemblyAI/assemblyai-cli/releases/download/v0.15/assemblyai_0.15_linux_amd64.tar.gz"
      sha256 "08fb0463cb861eb326e764ba232258a3b790208df52f5f4642e87bef4a950f96"

      def install
        bin.install "assemblyai"
      end
    end
  end

  test do
    output = shell_output("#{bin}/assemblyai-cli config 1234567890")
    expected = "Invalid token. Try again, and if the problem persists, contact support at support@assemblyai.com"
    assert_match expected, output

    output = shell_output("#{bin}/assemblyai-cli transcribe 1234567890")
    assert_match "You must login first. Run `assemblyai config <token>`\n", output

    output = shell_output("#{bin}/assemblyai-cli get 1234567890")
    assert_match "You must login first. Run `assemblyai config <token>`\n", output
  end
end
